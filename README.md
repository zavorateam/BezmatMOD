# GyverMOD - Проект прошивок для вейпов на базе Arduino

![Версия](https://img.shields.io/badge/Версия-2.07-blue)
![Платформа](https://img.shields.io/badge/Платформа-Arduino-green)
![Дисплеи](https://img.shields.io/badge/Дисплеи-Digit%20|%20OLED-yellow)

## Общее описание

GyverMOD - это серия прошивок для самодельных электронных сигарет (вейпов) на базе Arduino. Проект включает в себя две основные ветки:

1. **BezmatMOD (v1_DIGIT)** - базовая версия с 4-разрядным светодиодным дисплеем
2. **ZavoraMOD (v2_OLED)** - расширенная версия с OLED дисплеем 128x32 пикселя

Обе версии предлагают контроль мощности, настройки и информационную панель с различными функциями, адаптированными под соответствующий тип дисплея.

## BezmatMOD (v1_DIGIT)

### Описание

BezmatMOD - это базовая версия прошивки для вейпов с 4-разрядным светодиодным дисплеем на базе TM74HC595. Эта версия обеспечивает основной функционал для контроля напряжения и мощности.

### Основные функции

- Режим варивольта (регулировка напряжения)
- Режим вариватта (регулировка мощности)
- Отображение напряжения аккумулятора
- Таймер затяжки с автоотсечкой
- Энергосберегающий режим сна

### Необходимое оборудование

- Arduino Nano/Pro Mini (ATmega328P)
- 4-разрядный светодиодный дисплей TM74HC595
- MOSFET транзистор (IRF520N или аналог)
- Кнопки управления (3 шт)
- Аккумулятор Li-Ion 18650
- Контроллер заряда TP4056 (опционально)

### Схема подключения

| Arduino Pin | Подключение |
|-------------|-------------|
| D2          | Кнопка FIRE |
| D3          | Кнопка +    |
| D4          | Кнопка -    |
| D5          | TM74HC595 SCLK |
| D6          | TM74HC595 RCLK |
| D7          | TM74HC595 DIO |
| D10         | MOSFET (управление) |
| A0          | Измерение напряжения аккумулятора |
| A1          | Определение зарядки |

## ZavoraMOD (v2_OLED)

### Описание

ZavoraMOD - это модифицированная и улучшенная версия прошивки BezmatMOD для вейпов с OLED дисплеем 128x32 пикселя. Проект значительно расширяет функциональность, добавляя продвинутый интерфейс, анимации, игру и расширенные настройки.

### Основные функции

- **Улучшенный интерфейс пользователя**
  - Многоуровневое меню и подменю настроек
  - Анимированная индикация заряда батареи
  - Визуальная индикация подключенной зарядки
  - Предупреждение о разряде аккумулятора

- **Расширенный контроль**
  - Варивольт и вариватт режимы
  - Запрет на парение при зарядке аккумулятора
  - Энергосбережение с авторежимом сна
  - Автоотсечка затяжки по таймеру

- **Интерактивность**
  - Встроенная игра FlappyBird с таблицей рекордов
  - Статистика использования (общее время парения)
  - Улучшенное управление (кликание зажатием кнопки)

### Необходимое оборудование

- Arduino Nano/Pro Mini (ATmega328P)
- OLED дисплей SSD1306 128x32 пикселя (I2C интерфейс)
- MOSFET транзистор (IRF520N или аналог)
- Кнопки управления (4 шт)
- Аккумулятор Li-Ion 18650
- Контроллер заряда TP4056 (опционально)
- Повышающий преобразователь (опционально)

### Схема подключения

| Arduino Pin | Подключение |
|-------------|-------------|
| D2          | Кнопка FIRE |
| D3          | Кнопка SET  |
| D4          | Кнопка RIGHT|
| D5          | Кнопка LEFT |
| D10         | MOSFET (управление) |
| A0          | Измерение напряжения аккумулятора |
| A1          | Определение зарядки |
| A4 (SDA)    | OLED дисплей (SDA) |
| A5 (SCL)    | OLED дисплей (SCL) |

## Структура проекта

```
GyverMOD_DISP/                         - Проект BezmatMOD (v1_DIGIT)
├── v1_DIGIT/                      - Основная папка первой версии
│   ├── BezmatMOD.ino              - Основной файл прошивки
│   ├── Settings.h                 - Настройки и конфигурации
│   └── ...                        - Другие файлы проекта
└── MOD_libs/                      - Библиотеки для BezmatMOD
    └── TM74HC595-4dig-display     - Библиотека для LED дисплея

ZavoraMOD_OLED/                    - Проект ZavoraMOD (v2_OLED)
├── ZavoraMOD_v._2_OLED.ino        - Основной файл прошивки
├── ZavoraMOD_v._2_OLED_improved.ino - Улучшенная версия прошивки
├── Settings.h                     - Настройки и конфигурации
├── vape.h/cpp                     - Основные функции управления
├── Voltages.h/cpp                 - Контроль напряжения и мощности
├── Drawable.h/cpp                 - Отрисовка элементов интерфейса
├── images.h                       - Стандартные изображения и анимации
├── images_improved.h              - Улучшенные изображения и анимации
├── Game.h/cpp                     - Игровая логика
├── Button.h/cpp                   - Обработка нажатий кнопок
├── Externalizable.h/cpp           - Работа с EEPROM памятью
└── GameObjects.h/cpp              - Объекты для игры

lib_for_ZavoraMOD/                 - Библиотеки для ZavoraMOD
├── Adafruit_SSD1306               - Библиотека для OLED дисплея
├── Adafruit_GFX                   - Графическая библиотека
├── Adafruit_BusIO                 - Библиотека для работы с шинами
└── ...                            - Другие библиотеки
```

## Установка и настройка

### Общие требования

1. **Базовое оборудование**
   - Arduino IDE (версия 1.8.0 или выше)
   - Arduino Nano или Pro Mini (ATmega328P)
   - Необходимый дисплей (TM74HC595 для v1 или OLED SSD1306 для v2)
   - Кнопки, провода, аккумулятор 18650

2. **Калибровка напряжения**
   - При первом запуске установите `initial_calibration = 1` в Settings.h
   - Подключите вольтметр и измерьте напряжение между 5V и GND
   - Введите измеренное значение в монитор порта в милливольтах
   - Установите `initial_calibration = 0` и перепрошейте Arduino

### Для BezmatMOD (v1_DIGIT)

1. **Подготовка Arduino IDE**
   - Установите библиотеку TM74HC595-4dig-display из папки MOD_libs

2. **Настройка параметров**
   - Откройте файл Settings.h в папке v1_DIGIT
   - Настройте пины подключения и параметры работы

### Для ZavoraMOD (v2_OLED)

1. **Подготовка Arduino IDE**
   - Установите следующие библиотеки из папки lib_for_ZavoraMOD:
     - Adafruit_SSD1306
     - Adafruit_GFX
     - Adafruit_BusIO
     - TimerOne
     - LowPower
     - EEPROMex

2. **Настройка параметров**
   - Откройте файл Settings.h в папке ZavoraMOD_v._2_OLED
   - Настройте следующие параметры:
     - Пороги напряжения
     - Времена отсечки и сна
     - Пины подключения

## Использование

### BezmatMOD (v1_DIGIT)

**Основное управление:**
- **FIRE** - Основная кнопка парения
- **+/-** - Регулировка напряжения/мощности, навигация по меню

**Режимы работы:**
1. Режим варивольта (отображается значение напряжения)
2. Режим вариватта (отображается значение мощности)
3. Отображение напряжения батареи
4. Режим сна (экономия энергии)

### ZavoraMOD (v2_OLED)

**Основное управление:**
- **FIRE** - Основная кнопка парения
- **SET** - Подтверждение выбора/вход в подменю
- **RIGHT/LEFT** - Навигация по меню, изменение значений

**Меню:**
1. **VOLT** - Режим варивольта (изменение выходного напряжения)
2. **WATT** - Режим вариватта (изменение выходной мощности)
3. **COIL** - Настройка сопротивления спирали
4. **GAME** - Запуск игры FlappyBird
5. **TUNE** - Меню настроек
6. **INFO** - Информация об использовании
7. **SHTD** - Выключение (переход в режим сна)

**Меню настроек (TUNE):**
- **MVOLT** - Минимальное напряжение батареи
- **CUTOFF** - Время отсечки затяжки
- **SLEEP** - Время до перехода в режим сна

## Создание собственных анимаций (для ZavoraMOD)

Вы можете создать свои анимации и изображения для ZavoraMOD, используя инструмент [image2cpp](https://javl.github.io/image2cpp/):

1. Создайте изображение в любом редакторе (PNG, SVG)
2. Загрузите его в image2cpp
3. Настройте параметры (инверсия, формат вывода)
4. Скопируйте сгенерированный код в images_improved.h

## Авторы и вклад

- **AlexGyver** - Идея и концепция оригинальной прошивки GyverMOD
- **EM1LJAN** - Оригинальный автор BezmatMOD/ZavoraMOD (11.08.2021)
- **Metallolom/Vaultek** - Модификации и улучшения (05.05.2023)
- **Vaultek** - Улучшенная версия ZavoraMOD (09.07.2023)

## Лицензия

Данный проект распространяется под открытой лицензией. Вы можете свободно использовать, модифицировать и распространять код при условии сохранения авторства.

## Благодарности

- [AlexGyver](https://github.com/AlexGyver/) - За оригинальную прошивку GyverMOD
- [Adafruit](https://www.adafruit.com/) - За библиотеки для работы с дисплеем
- [javl](https://github.com/javl) - За утилиту image2cpp

## Предупреждение

Данный проект предназначен только для образовательных целей. Авторы не несут ответственности за любой ущерб, причиненный в результате использования данного программного обеспечения или модификации оборудования. Электронные сигареты могут быть опасны для здоровья, и их использование регулируется законодательством вашей страны. 